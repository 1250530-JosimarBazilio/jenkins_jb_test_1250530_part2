# ===========================================
# Feature Flags and Release Strategies Configuration
# ===========================================
# Supports: Dark Launch, Kill Switch
#
# Release Strategy Labels:
# - release-strategy: dark-launch | kill-switch
# - feature-flags-enabled: true

# ===========================================
# GLOBAL SETTINGS
# ===========================================

# Master kill switch - set to true to disable ALL features
features.global-kill-switch=false

# ===========================================
# DARK LAUNCH CONFIGURATION
# ===========================================

# Enable dark launch functionality
features.dark-launch.enabled=true

# Percentage of traffic to shadow (for comparison)
features.dark-launch.shadow-traffic-percentage=10.0

# Log shadow request results
features.dark-launch.log-shadow-requests=true

# Compare production vs shadow responses
features.dark-launch.compare-responses=true

# ===========================================
# KILL SWITCH CONFIGURATION
# ===========================================

# Auto-kill features when error threshold is reached
features.kill-switch.auto-kill-on-errors=true

# Number of errors to trigger auto-kill
features.kill-switch.error-threshold=10

# Time window for error counting (seconds)
features.kill-switch.error-window-seconds=60

# Send notification when feature is killed
features.kill-switch.notify-on-kill=true

# Webhook URL for kill notifications (optional)
# features.kill-switch.notification-webhook=https://hooks.slack.com/your-webhook

# ===========================================
# FEATURE FLAGS - STABLE FEATURES
# ===========================================

# Book CRUD operations (stable, always enabled)
features.flags.book-create.enabled=true
features.flags.book-create.dark-launch=false
features.flags.book-create.rollout-percentage=100

features.flags.book-update.enabled=true
features.flags.book-update.dark-launch=false
features.flags.book-update.rollout-percentage=100

features.flags.book-delete.enabled=true
features.flags.book-delete.dark-launch=false
features.flags.book-delete.rollout-percentage=100

features.flags.book-search.enabled=true
features.flags.book-search.dark-launch=false
features.flags.book-search.rollout-percentage=100

# ===========================================
# FEATURE FLAGS - DARK LAUNCH FEATURES
# ===========================================

# AI-powered book recommendations (dark launch)
features.flags.book-recommendations.enabled=false
features.flags.book-recommendations.dark-launch=true
features.flags.book-recommendations.rollout-percentage=0

# Book analytics (dark launch)
features.flags.book-analytics.enabled=false
features.flags.book-analytics.dark-launch=true
features.flags.book-analytics.rollout-percentage=0

# AI summary generation (dark launch)
features.flags.book-ai-summary.enabled=false
features.flags.book-ai-summary.dark-launch=true
features.flags.book-ai-summary.rollout-percentage=0

# Batch import (dark launch)
features.flags.book-batch-import.enabled=false
features.flags.book-batch-import.dark-launch=true
features.flags.book-batch-import.rollout-percentage=0

# ===========================================
# ASYNC CONFIGURATION (for shadow execution)
# ===========================================
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
